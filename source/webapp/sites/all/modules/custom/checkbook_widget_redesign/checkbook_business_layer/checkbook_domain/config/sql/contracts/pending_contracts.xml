<statements>
    <!--GetPendingContractsByAwardMethods,GetCountPendingContractsByAwardMethods-->
    <statement name="GetPendingContractsByAwardMethods " datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="mwbe" />
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <sql>
            SELECT
            a.award_method_id,
            a.award_method_name,
            SUM(COALESCE(a.original_contract_amount,0)) AS original_amount_sum,
            SUM(COALESCE(revised_maximum_amount,0)) AS current_amount_sum,
            COUNT(contract_number) AS total_contracts
            FROM pending_contracts a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_agency c on c.agency_id = a.awarding_agency_id
            JOIN vendor d on d.vendor_id = a.vendor_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                    <exp op="=" dbField="d.vendor_id" paramName="vendor" />
                </exp>
            </where>
            GROUP BY a.type_of_year,e.award_method_id,e.award_method_name
        </sql>
    </statement>
    <statement name="GetCountPendingContractsByAwardMethods" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="status" type="string"/>
        <param name="doctype" />
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <sql>
            SELECT COUNT(DISTINCT a.award_method_id) as record_count
            FROM pending_contracts a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_agency c on c.agency_id = a.awarding_agency_id
            JOIN vendor d on d.vendor_id = a.vendor_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="=" dbField="a.vendor_id" paramName="vendor" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                </exp>
            </where>
        </sql>
    </statement>
</statements>
