<statements>
    <statement name="GetCityWideChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT
            check_eft_issued_date as issue_date,
            vendor_name,
            agency_name,
            check_amount,
            expenditure_object_name as expense_category,
            agency_id,
            vendor_id,
            expenditure_object_id,
            department_name
            FROM disbursement_line_item_details
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetCountCityWideChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT DISTINCT count(check_eft_issued_date) as record_count FROM disbursement_line_item_details
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetMwbeChecks" datasource="checkbook">
        <param name="fiscal_year_id" required ="true"/>
        <param name="calendar_year_id" />
        <sql>
            SELECT check_eft_issued_date as issue_date,
            vendor_name as prime_vendor_name,
            agency_name,
            check_amount,
            expenditure_object_name as expense_category,
            agency_id,
            vendor_id,
            expenditure_object_id,
            department_name,
            industry_type_id
            FROM disbursement_line_item_details
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetCountMwbeChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT DISTINCT count(check_eft_issued_date) as record_count FROM disbursement_line_item_details
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetOGEChecks" datasource="checkbook">
        <param name="fiscal_year_id" required ="true"/>
        <param name="calendar_year_id" />
        <sql>
            SELECT check_eft_issued_date as issue_date,
            vendor_name as prime_vendor_name,
            agency_name,
            check_amount,
            expenditure_object_name as expense_category,
            agency_id,
            vendor_id,
            expenditure_object_id,
            department_name
            FROM disbursement_line_item_details
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetCountOGEChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT DISTINCT count(check_eft_issued_date) as record_count FROM disbursement_line_item_details
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetSVmwbeChecks" datasource="checkbook">
        <param name="fiscal_year_id" required ="true"/>
        <param name="calendar_year_id" />
        <sql>
            SELECT l1.check_eft_issued_date as check_issue_date,
            l1.agency_id,
            l1.agency_name,
            l1.vendor_id,
            l1.vendor_name,
            l2.legal_name AS legal_name_checkbook_sub_vendor,
            l1.prime_vendor_id,
            l3.legal_name AS legal_name_checkbook_prime_vendor,
            l1.check_amount,
            l1.minority_type_id
            FROM subcontract_spending_details l1
            LEFT OUTER JOIN subvendor l2 ON l2.vendor_id = l1.vendor_id
            LEFT OUTER JOIN vendor l3 ON l3.vendor_id = l1.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetCountSVmwbeChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT DISTINCT count(check_eft_issued_date) as record_count FROM subcontract_spending_details l1
            LEFT OUTER JOIN subvendor l2 ON l2.vendor_id = l1.vendor_id
            LEFT OUTER JOIN vendor l3 ON l3.vendor_id = l1.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetSVChecks" datasource="checkbook">
        <param name="fiscal_year_id" required ="true"/>
        <param name="calendar_year_id" />
        <sql>
            SELECT l1.check_eft_issued_date as issue_date,
            l1.agency_id,
            l1.agency_name,
            l1.vendor_id,
            l1.vendor_name,
            l2.legal_name AS legal_name_checkbook_sub_vendor,
            l1.prime_vendor_id,
            l3.legal_name AS legal_name_checkbook_prime_vendor,
            l1.check_amount,
            l1.minority_type_id
            FROM subcontract_spending_details l1
            LEFT OUTER JOIN subvendor l2 ON l2.vendor_id = l1.vendor_id
            LEFT OUTER JOIN vendor l3 ON l3.vendor_id = l1.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetCountSVChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT DISTINCT count(check_eft_issued_date) as record_count FROM subcontract_spending_details l1
            LEFT OUTER JOIN subvendor l2 ON l2.vendor_id = l1.vendor_id
            LEFT OUTER JOIN vendor l3 ON l3.vendor_id = l1.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetmwbeSVChecks" datasource="checkbook">
        <param name="fiscal_year_id" required ="true"/>
        <param name="calendar_year_id" />
        <sql>
            SELECT l1.check_eft_issued_date as issue_date,
            l1.agency_name,
            l1.check_amount,
            l1.expenditure_object_name,
            l1.agency_id,
            l1.prime_vendor_id,
            l2.legal_name AS legal_name_checkbook_prime_vendor,
            l1.industry_type_id,
            l1.minority_type_id
            FROM subcontract_spending_details l1
            LEFT OUTER JOIN vendor l2 ON l2.vendor_id = l1.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
    <statement name="GetCountmwbeSVChecks" datasource="checkbook">
        <param name="year" required ="true"/>
        <param name="yeartype" required ="true"/>
        <sql>
            SELECT DISTINCT count(check_eft_issued_date) as record_count FROM subcontract_spending_details l1
            LEFT OUTER JOIN vendor l2 ON l2.vendor_id = l1.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="B">
                        <exp op="=" dbField="check_eft_issued_nyc_year_id" paramName="year" />
                    </exp>
                    <exp op="IF" condition="=" paramName="yeartype" compareValue="C">
                        <exp op="=" dbField="calendar_fiscal_year_id" paramName="year" />
                    </exp>
                </exp>
            </where>
        </sql>
    </statement>
</statements>