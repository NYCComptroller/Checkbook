<statements>
  <!--GetNychaVendors-->
  <statement name="GetContractsByVendors" datasource="checkbook_nycha">
    <param name="year" required ="true" type="int"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT vendor_name,
        vendor_number,
        vendor_id,
        purchase_order_count,
        spend_to_date,
        total_amount,
        original_amount
      FROM contracts_fy_vendor_summary_vw
      <where>
        <exp op="AND">
          <exp op="=" dbField="fiscal_year_id" paramName="year" />
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetNychaAwardMethods-->
  <statement name="GetContractsByAwardMethods" datasource="checkbook_nycha">
    <param name="year" required ="true" type="int"/>
    <sql>
      SELECT  fiscal_year_id,fiscal_year,
      award_method_name, purchase_order_count, total_amount,original_amount,spend_to_date
      FROM contracts_fy_award_method_summary_vw
      <where>
        <exp op="AND">
          <exp op="=" dbField="fiscal_year_id" paramName="year" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetNychaPurchaseOrders-->
  <statement name="GetContractsByPurchaseOrders" datasource="checkbook_nycha">
  <param name="year" required ="true" type="int"/>
    <param name="vendor" type="int"/>
  <sql>
    SELECT fiscal_year_id,fiscal_year,
    po_number,purpose, vendor_name,total_amount,original_amount, spend_to_date
    FROM  contracts_fy_po_vendor_summary_vw
    <where>
      <exp op="AND">
        <exp op="=" dbField="fiscal_year_id" paramName="year" />
        <exp op="=" dbField="vendor_id" paramName="vendor" />
      </exp>
    </where>
  </sql>
</statement>
  <statement name="GetContractsByBoroughs" datasource="checkbook_nycha">
    <param name="year" required ="true" type="int"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT fiscal_year_id,fiscal_year,
      location_borough_name,purchase_order_count,total_amount,original_amount,spend_to_date
      FROM  contracts_fy_borough_summary_vw
      <where>
        <exp op="AND">
          <exp op="=" dbField="fiscal_year_id" paramName="year" />
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetNychaBlanketAgreements-->
  <statement name="GetContractsBlanketAgreements" datasource="checkbook_nycha">
    <param name="year" required ="true" type="yearfix"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT
      purpose, vendor_name, total_amount, original_amount, spend_to_date
      FROM contract_agreements_fy_vendor
      <where>
        <exp op="AND">
          <!--WHERE  '2016' BETWEEN FY_Start AND FY_End-->
          <exp op="BETWEEN" paramName="year" dbField="FY_Start,FY_End" />
          <exp op="=" dbField="transaction_category_code">'BA'</exp>
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetBlanketAgreementModifications-->
  <statement name="GetContractsBlanketAgreementModifications" datasource="checkbook_nycha">
    <param name="year" required ="true" type="yearfix"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT
      purpose, vendor_name, total_amount, original_amount, spend_to_date,
      dollar_difference, percent_difference
      FROM contract_agreements_fy_vendor
      <where>
        <exp op="AND">
          <!--WHERE  '2016' BETWEEN FY_Start AND FY_End-->
          <exp op="BETWEEN" paramName="year" dbField="FY_Start,FY_End" />
          <exp op="=" dbField="transaction_category_code">'BA'</exp>
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetGrants-->
  <statement name="GetContractsByGrants" datasource="checkbook_nycha">
    <param name="year" required ="true" type="int"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT
       fiscal_year_id,grant_name, purchase_order_count,total_amount, original_amount, spend_to_date
      FROM contracts_fy_grant_summary_vw
      <where>
        <exp op="AND">
          <exp op="=" dbField="fiscal_year_id" paramName="year" />
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetNychaPlannedAgreements-->
  <statement name="GetContractsPlannedAgreements" datasource="checkbook_nycha">
    <param name="year" required ="true" type="yearfix"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT
      purpose, vendor_name, total_amount, original_amount, spend_to_date
      FROM contract_agreements_fy_vendor
      <where>
        <exp op="AND">
          <!--WHERE  '2016' BETWEEN FY_Start AND FY_End-->
          <exp op="BETWEEN" paramName="year" dbField="FY_Start,FY_End" />
          <exp op="=" dbField="transaction_category_code">'PA'</exp>
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
  <!--GetPlannedAgreementModifications-->
  <statement name="GetContractsPlannedAgreementModifications" datasource="checkbook_nycha">
    <param name="year" required ="true" type="yearfix"/>
    <param name="vendor" type="int"/>
    <sql>
      SELECT
      purpose, vendor_name, total_amount, original_amount, spend_to_date,
      dollar_difference, percent_difference
      FROM contract_agreements_fy_vendor
      <where>
        <exp op="AND">
          <!--WHERE  '2016' BETWEEN FY_Start AND FY_End-->
          <exp op="BETWEEN" paramName="year" dbField="FY_Start,FY_End" />
          <exp op="=" dbField="transaction_category_code">'PA'</exp>
          <exp op="=" dbField="vendor_id" paramName="vendor" />
        </exp>
      </where>
    </sql>
  </statement>
</statements>
