<statements>
    <!--GetSubContractsByAwardMethods,GetCountSubContractsByAwardMethods-->
    <statement name="GetSubContractsByAwardMethods" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="mwbe" />
        <param name="status" type="string"/>
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <sql>
            SELECT
            a.type_of_year,
            e.award_method_id,
            e.award_method_name,
            SUM(COALESCE(a.original_contract_amount,0)) AS original_amount_sum,
            SUM(COALESCE(a.maximum_contract_amount,0)) AS current_amount_sum,
            SUM(COALESCE(a.spending_amount,0)) AS spending_amount_sum,
            COUNT(contract_number) AS total_contracts
            FROM aggregateon_subven_contracts_cumulative_spending a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_award_method e ON e.award_method_id = a.award_method_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="a.agency_id" paramName="agency" />
                    <exp op="=" dbField="a.vendor_id" paramName="vendor" />
                </exp>
            </where>
            GROUP BY a.type_of_year,e.award_method_id,e.award_method_name
        </sql>
    </statement>
    <statement name="GetCountSubContractsByAwardMethods" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="mwbe" />
        <param name="status" type="string"/>
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <sql>
            SELECT COUNT(DISTINCT a.award_method_id) as record_count
            FROM aggregateon_subven_contracts_cumulative_spending a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_agency c on c.agency_id = a.agency_id
            JOIN vendor d on d.vendor_id = a.vendor_id
            JOIN ref_award_method e ON e.award_method_id = a.award_method_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                    <exp op="=" dbField="d.vendor_id" paramName="vendor" />
                </exp>
            </where>
        </sql>
    </statement>
    <!--GetSubContractsByIndustries,GetCountSubContractsByIndustries-->
    <statement name="GetSubContractsByIndustries" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="status" type="string"/>
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <param name="subvendor" />
        <param name="mwbe" />
        <param name="awdmethod" />
        <param name="csize" />
        <param name="cindustry" />
        <sql>
            SELECT
            e.industry_type_id,
            e.industry_type_name,
            SUM(COALESCE(original_contract_amount,0)) AS original_amount_sum,
            SUM(COALESCE(maximum_contract_amount,0)) AS current_amount_sum,
            SUM(COALESCE(spending_amount,0)) AS spending_amount_sum,
            COUNT(contract_number) AS total_contracts
            FROM aggregateon_subven_contracts_cumulative_spending a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_agency c on c.agency_id = a.agency_id
            JOIN ref_industry_type e ON e.industry_type_id = a.industry_type_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                    <exp op="=" dbField="a.prime_vendor_id" paramName="vendor" />
                    <exp op="=" dbField="a.vendor_id" paramName="subvendor" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="a.award_method_id" paramName="awdmethod" />
                    <exp op="=" dbField="a.award_size_id" paramName="csize" />
                    <exp op="=" dbField="a.industry_type_id" paramName="cindustry" />
                </exp>
            </where>
            GROUP BY e.industry_type_id,e.industry_type_name
        </sql>
    </statement>
    <statement name="GetCountSubContractsByIndustries" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="status" type="string"/>
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <param name="subvendor" />
        <param name="mwbe" />
        <param name="awdmethod" />
        <param name="csize" />
        <param name="cindustry" />
        <sql>
            SELECT COUNT(contract_number) AS record_count
            FROM aggregateon_subven_contracts_cumulative_spending a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_agency c on c.agency_id = a.agency_id
            JOIN ref_industry_type e ON e.industry_type_id = a.industry_type_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                    <exp op="=" dbField="a.prime_vendor_id" paramName="vendor" />
                    <exp op="=" dbField="a.vendor_id" paramName="subvendor" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="a.award_method_id" paramName="awdmethod" />
                    <exp op="=" dbField="a.award_size_id" paramName="csize" />
                    <exp op="=" dbField="a.industry_type_id" paramName="cindustry" />
                </exp>
            </where>
        </sql>
    </statement>
    <!--GetSubContractsBySize,GetCountSubContractsBySize-->
    <statement name="GetSubContractsBySize" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="status" type="string"/>
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <param name="subvendor" />
        <param name="mwbe" />
        <param name="awdmethod" />
        <param name="csize" />
        <param name="cindustry" />
        <sql>
            SELECT
            e.award_size_id,
            e.award_size_name,
            SUM(COALESCE(a.original_contract_amount,0)) AS original_amount_sum,
            SUM(COALESCE(a.maximum_contract_amount,0)) AS current_amount_sum,
            SUM(COALESCE(a.spending_amount,0)) AS spending_amount_sum,
            COUNT(contract_number) AS total_contracts
            FROM aggregateon_subven_contracts_cumulative_spending a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_award_size e ON e.award_size_id = a.award_size_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                    <exp op="=" dbField="a.prime_vendor_id" paramName="vendor" />
                    <exp op="=" dbField="a.vendor_id" paramName="subvendor" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="a.award_method_id" paramName="awdmethod" />
                    <exp op="=" dbField="a.award_size_id" paramName="csize" />
                    <exp op="=" dbField="a.industry_type_id" paramName="cindustry" />
                </exp>
            </where>
            GROUP BY e.award_size_id,e.award_size_name
        </sql>
    </statement>
    <statement name="GetCountSubContractsBySize" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="doctype" />
        <param name="status" type="string"/>
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <param name="subvendor" />
        <param name="mwbe" />
        <param name="awdmethod" />
        <param name="csize" />
        <param name="cindustry" />
        <sql>
            SELECT COUNT(contract_number) AS record_count
            FROM aggregateon_subven_contracts_cumulative_spending a
            JOIN ref_document_code b ON a.document_code_id = b.document_code_id
            JOIN ref_agency c on c.agency_id = a.agency_id
            JOIN ref_award_size e ON e.award_size_id = a.award_size_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="a.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="a.type_of_year" paramName="yeartype" />
                    <exp op="=" dbField="a.status_flag" paramName="status" />
                    <exp op="IN" dbField="b.document_code" paramName="doctype" />
                    <exp op="=" dbField="c.agency_id" paramName="agency" />
                    <exp op="=" dbField="a.prime_vendor_id" paramName="vendor" />
                    <exp op="=" dbField="a.vendor_id" paramName="subvendor" />
                    <exp op="IN" dbField="a.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="a.award_method_id" paramName="awdmethod" />
                    <exp op="=" dbField="a.award_size_id" paramName="csize" />
                    <exp op="=" dbField="a.industry_type_id" paramName="cindustry" />
                </exp>
            </where>
        </sql>
    </statement>
    <!--  GetSubContractsByPrimeVendors  -->
    <statement name="GetSubContractsByPrimeVendors" datasource="checkbook">
        <param name="year" required ="true" type="int"/>
        <param name="yeartype" required ="true" type="string" />
        <param name="status" type="string"/>
        <param name="doctype" />
        <param name="agency" type="int" />
        <param name="vendor" type="int" />
        <param name="mwbe" />
        <param name="awdmethod" />
        <param name="csize" />
        <param name="cindustry" />
        <sql>
           SELECT prime_vendor_id,
                v.legal_name AS vendor_name,
                type_of_year,
                prime_minority_type_id AS minority_type_id,
                SUM(COALESCE(original_contract_amount,0)) AS original_amount_sum,
                SUM(COALESCE(maximum_contract_amount,0)) AS current_amount_sum,
                SUM(COALESCE(spending_amount,0)) AS spending_amount_sum,
                COUNT(contract_number) AS total_contracts
            FROM aggregateon_subven_contracts_cumulative_spending s0
                 JOIN ref_document_code rfd ON rfd.document_code_id = s0.document_code_id
                 JOIN vendor v ON v.vendor_id = s0.prime_vendor_id
            <where>
                <exp op="AND">
                    <exp op="=" dbField="s0.fiscal_year_id" paramName="year" />
                    <exp op="=" dbField="s0.type_of_year" paramName="yeartype" />
                    <exp op="IN" dbField="rfd.document_code" paramName="doctype" />
                    <exp op="=" dbField="s0.document_agency_id" paramName="agency" />
                    <exp op="IN" dbField="s0.minority_type_id" paramName="mwbe" />
                    <exp op="=" dbField="s0.vendor_id" paramName="vendor" />
                    <exp op="=" dbField="s0.award_method_id" paramName="awdmethod" />
                    <exp op="=" dbField="s0.award_size_id" paramName="csize" />
                    <exp op="=" dbField="s0.industry_type_id" paramName="cindustry" />
                </exp>
            </where>
            GROUP BY type_of_year, prime_vendor_id, prime_minority_type_id, v.legal_name 
        </sql>
    </statement>
</statements>