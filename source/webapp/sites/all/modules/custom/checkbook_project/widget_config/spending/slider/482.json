{
    "widgetType": "phpparser",
    "no_results_content": "No Results Found",
    "cleanURLParameters":["year","calyear","agency","yeartype","vendor","mwbe","industry","vendor","subvendor"],
    "model": {
        "join": {"method": "Union"},
        "series": [
            {
                "dataset": "checkbook:spending_data",
                "preProcessConfiguration":"
                    $is_sub_vendor = _checkbook_check_is_sub_vendor_page();
                    $is_mwbe = _checkbook_check_is_mwbe_page();
                    $node->is_sub_vendor = $is_sub_vendor;
                    $node->is_mwbe = $is_mwbe && !$is_sub_vendor;
                    $node->is_mwbe_sub_vendor = $is_mwbe && $is_sub_vendor;
                    if($node->is_mwbe) $node->widgetConfig->model->series[0]->dataset = 'checkbook:spending_mwbe_data';
                    if($node->is_sub_vendor || $node->is_mwbe_sub_vendor) $node->widgetConfig->model->series[0]->dataset = 'checkbook:spending_subven_data';
                ",
                "columns": ["check_amount_sum","category.category"],
                "seriesURLParamMap":{
                    "year":"year.year",
                    "agency":"agency_id",
                    "yeartype":"type_of_year",
                    "vendor":"prime_vendor.prime_vendor",
                    "subvendor":"sub_vendor.sub_vendor",
                    "mwbe":"minority_type_id",
                    "industry":"industry_type_id"
                },
                "allowedParams":["year.year","agency_id","type_of_year","prime_vendor.prime_vendor","sub_vendor.sub_vendor","minority_type_id","industry_type_id"],
                "seriesDefaultParameters":{"year.year":"1","type_of_year":"B"},
                "adjustSerieParameters":"

                    if(!$node->is_sub_vendor && isset($serieParameters['prime_vendor.prime_vendor'])) {
                        $serieParameters['vendor.vendor'] = $serieParameters['prime_vendor.prime_vendor'];
                        unset($serieParameters['prime_vendor.prime_vendor']);
                    }
                    if(!$node->is_mwbe && !$node->is_mwbe_sub_vendor) {
                        unset($serieParameters['minority_type_id']);
                        unset($serieParameters['industry_type_id']);
                        return $serieParameters;
                    }
                    if(!isset($serieParameters['minority_type_id']))
                        $serieParameters['minority_type_id'] = data_controller_get_operator_factory_instance()->initiateHandler(NotEqualOperatorHandler::$OPERATOR__NAME, 2);
                    return $serieParameters;

                "
            }
        ]
    },
    "template": "spending_bottom_slider"
}