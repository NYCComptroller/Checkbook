{
  "widgetType":"data_tables",
  "widgetSubType":"dataTableList",
  "stickyHeader":true,
  "cleanURLParameters":["year","curamtr","pcontdesc","appdate","startdate","enddate","vendornm_exact","vendorid","vendornm","responsibilitynm_exact","fundingnm_exact","industrynm_exact","agreement_type", "po_num", "po_num_exact", "agency","awdmethod","contract_type"],
  "urlParamMap":{"year":"release_approved_year_id", "curamtr":"release_line_total_amount","industrynm_exact":"industry_type_id","fundingnm_exact":"funding_source_id","vendornm_exact":"vendor_name","agreement_type":"agreement_type_code",
                 "po_num":"contract_id","responsibilitynm_exact":"responsibility_center_id","po_num_exact":"contract_id", "agency":"agency_id", "awdmethod":"award_method_id","contract_type": "contract_type_code",
    "pcontdesc":"purpose","appdate": "release_approved_date","startdate": "agreement_start_date","enddate": "agreement_end_date","vendornm": "vendor_name","vendorid": "vendor_id"
  },
  "paramTypeConfig": {
    "po_num": "like",
    "vendornm": "like",
    "curamtr": "rangeid",
    "pcontdesc": "contains",
    "startdate": "range",
    "enddate": "range",
    "appdate": "range"
  },
  "header":"
        $header = NULL;
        $header .= widget_data_tables_export_link($node);
        return $header;
  ",
  "useList":true,
  "getTotalDataCount":true,
  "limit":"35",
  "noDataInitialLoad":true,
  "html_class":"initiative-table",
  "no_results_content":"No Results Found",
  "dataset":"checkbook_nycha:nycha_all_agreements",
  "columns": [ "contract_id", "agreement_type_name", "release_number", "shipment_number", "distribution_number", "agreement_start_date",
    "agreement_end_date", "release_approved_date", "release_total_amount", "release_original_amount", "release_spend_to_date",
    "purpose", "vendor_name", "location_descr", "location_borough_name", "contract_type_descr", "award_method_name", "grant_name",
    "expenditure_type_descr", "industry_type_name", "funding_source_descr", "responsibility_center_descr", "program_phase_descr",
    "gl_project_descr", "commodity_category_descr","release_line_total_amount"],
  "adjustParameters":"
      if(function_exists('_checkbook_project_applyParameterFilters')){
       $parameters = _checkbook_project_applyParameterFilters($node,$parameters);
      }
     return $parameters;
  ",
  "caption":"",
  "derivedColumns": {
  "contract_purpose_formatted": {
  "expression": "_get_tooltip_markup($row['purpose'],36)"
    },
   "contract_type_formatted":{
       "expression": "_get_tooltip_markup($row['contract_type_descr'],36)"
    },
   "responsibility_center_descr_formatted":{
        "expression": "_get_tooltip_markup($row['responsibility_center_descr'],36)"
    },
    "program_phase_descr_formatted":{
    "expression": "_get_tooltip_markup($row['program_phase_descr'],36)"
    },
    "gl_project_descr_formatted":{
      "expression": "_get_tooltip_markup($row['gl_project_descr'],36)"
     },
    "commodity_category_descr_formatted":{
      "expression": "_get_tooltip_markup($row['commodity_category_descr'],36)"
     }
  },
  "skipCustomPadding":true,
  "table_columns": [
    {"labelAlias":"contract_id","column":"contract_id"},
    {"label":"","column":"", "export":false},
    {"labelAlias":"purchase_order_type","column":"agreement_type_name"},
    {"labelAlias":"release_number","column":"release_number"},
    {"labelAlias":"shipment_number","column":"shipment_number"},
    {"labelAlias":"distribution_number","column":"distribution_number"},
    {"labelAlias":"start_date","column":"agreement_start_date"},
    {"labelAlias":"end_date","column":"agreement_end_date"},
    {"labelAlias":"release_approved_date","column":"release_approved_date"},
    {"labelAlias":"current_amount","column":"release_total_amount"},
    {"labelAlias":"original_amount","column":"release_original_amount"},
    {"labelAlias":"spend_to_date","column":"release_spend_to_date"},
    {"label":"","column":"", "export":false},
    {"labelAlias":"contract_purpose","column":"contract_purpose_formatted"},
    {"labelAlias":"vendor_name","column":"vendor_name"},
    {"labelAlias":"location","column":"location_descr"},
    {"labelAlias":"borough","column":"location_borough_name"},
    {"labelAlias":"contract_type","column":"contract_type_formatted"},
    {"labelAlias":"award_method","column":"award_method_name"},
    {"labelAlias":"grant","column":"grant_name"},
    {"labelAlias":"expenditure_type","column":"expenditure_type_descr"},
    {"labelAlias":"contract_industry","column":"industry_type_name"},
    {"labelAlias":"funding_source","column":"funding_source_descr"},
    {"labelAlias":"responsibility_center","column":"responsibility_center_descr_formatted"},
    {"labelAlias":"program","column":"program_phase_descr_formatted"},
    {"labelAlias":"project","column":"gl_project_descr_formatted"},
    {"labelAlias":"commodity_category","column":"commodity_category_descr_formatted"},
    {"label":"","column":"", "export":false}
    ],
  "adjustParameters":"
      if(function_exists('_checkbook_project_applyParameterFilters')){
      $parameters = _checkbook_project_applyParameterFilters($node,$parameters);
    }
    return $parameters;
  ",
  "adjustDataTableOptions":"
      $adjustDataTableOptions = $node->widgetConfig->dataTableOptions;
      if(!$node->is_master_agreement) {
      $adjustDataTableOptions->fnInitComplete = '##function () { new FixedColumns( oTable, {\"iLeftColumns\": 4,\"iLeftWidth\": 360} );}##';
    }",
  "dataTableOptions":{
    "bRetrieve":true,
    "bServerSide":true,
    "bProcessing":true,
    "bFilter":false,
    "bPaginate":true,
    "iDisplayLength":35,
    "sPaginationType":"full_numbers",
    "sDom":"<pr><t><ip>",
    "oLanguage": {
    "sInfo":"Displaying transactions _START_ - _END_ of _TOTAL_",
    "sProcessing":"<img src='/sites/all/themes/checkbook/images/loading_large.gif' title='Processing...'/>"
    },
    "bInfo":true,
    "aoColumns": [
      {"sClass":"number-center", "sWidth":"150px","asSorting":["asc","desc"]},
      {"bSortable":false,"sWidth":"10px"},
      {"sClass":"text", "sWidth":"150px","asSorting":["asc","desc"]},
      {"sClass":"number-center", "sWidth":"50px","asSorting":["asc","desc"]},
      {"sClass":"number-center", "sWidth":"75px","asSorting":["asc","desc"]},
      {"sClass":"number-center", "sWidth":"75px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"100px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"100px","asSorting":["asc","desc"]},
      {"sClass":"number", "sWidth":"110px","asSorting":["asc","desc"]},
      {"sClass":"number", "sWidth":"110px","asSorting":["asc","desc"]},
      {"sClass":"number", "sWidth":"110px","asSorting":["asc","desc"]},
      {"sClass":"number", "sWidth":"110px","asSorting":["asc","desc"]},
      {"bSortable":false,"sWidth":"50px"},
      {"sClass":"text", "sWidth":"200px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"220px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"220px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"220px","asSorting":["asc","desc"]},
      {"sClass":"text", "sWidth":"180px","asSorting":["asc","desc"]},
      {"bSortable":false,"sWidth":"2px"}
    ],
    "aaSorting":[[0,"desc"]],
    "sScrollX":"100%",
    "bScrollCollapse": true
  },
  "customJS":"
    jQuery('#dtl_expand').live( 'click',function () {
    var nTr = this.parentNode.parentNode.parentNode;
    if ( jQuery(this).attr('class').match('loader') ){return;}
    if ( jQuery(this).attr('class').match('expanded') ){
    jQuery(this).removeClass('expanded').addClass('collapsed');
    oTable.fnClose( nTr );
    }
    else{
    jQuery(this).removeClass('collapsed').addClass('loader');
    fnLoadChildRecords(nTr, jQuery(this));
    }

    } );
  ",
    "customExternalJS":"

    function prepareTableListFilterUrl() {
          var oVendorNms = getNamedFilterCriteria('fvendorNm');
          var oVendorIds = getNamedFilterCriteria('fvendorId');
          var oPOnums = getNamedFilterCriteria('fPONumber');
          var oAgencys = getNamedFilterCriteria('fagencyId');
          var oAgreementTypes = getNamedFilterCriteria('fagreementType');
          var oAwdMethod = getNamedFilterCriteria('fAwdMethodId');
          var oIndustryNms = getNamedFilterCriteria('fIndustryId');
          var oResCenterNms = getNamedFilterCriteria('fResCenterId');
          var oFundingNms = getNamedFilterCriteria('fFundingId');
          var oCurAmount = getNamedFilterCriteria('fCurAmount');
          var cUrl = oTable.fnSettings().sAjaxSource;
          var cUrlArray = cUrl.split('/');
          cUrl = adjustUrlParameter(cUrl,'vendorid',oVendorIds);
          cUrl = adjustUrlParameter(cUrl,'vendornm_exact',oVendorNms);
          cUrl = adjustUrlParameter(cUrl,'fundingnm_exact',oFundingNms);
          cUrl = adjustUrlParameter(cUrl,'curamtr',oCurAmount);
          cUrl = adjustUrlParameter(cUrl,'responsibilitynm_exact',oResCenterNms);
           cUrl = adjustUrlParameter(cUrl,'industrynm_exact',oIndustryNms);
          cUrl = adjustUrlParameter(cUrl,'po_num_exact',oPOnums);
          cUrl = adjustUrlParameter(cUrl,'agency',oAgencys);
          cUrl = adjustUrlParameter(cUrl,'agreement_type',oAgreementTypes);
          cUrl = adjustUrlParameter(cUrl,'awdmethod',oAwdMethod);
          return cUrl;
    }"
}
