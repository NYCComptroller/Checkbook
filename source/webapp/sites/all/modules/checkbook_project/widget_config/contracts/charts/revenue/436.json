{
"widgetType": "highcharts",
"header":"
    $header = '<h2 class=\"chart-title\" style=\"display:none;\">' . $node->widgetConfig->chartTitle . '</h2>';
    $header .= ChartUtil::generateGridViewLink($node);
    return $header;
",
"footer":"$footer ='';return $footer;",
"gridConfig":{
    "template":"highchart_contracts_topamount_grid_view",
    "html_class":"chart-grid-view-table four-columns",
    "table_columns": [
        {
            "labelAlias": "contract_id",
            "column": "contract_number"
        },
        {
            "labelAlias": "current_amount",
            "column": "maximum_contract_amount"
        },
        {
            "labelAlias": "vendor_name",
            "column": "legal_name@checkbook:vendor"
        },
        {
            "labelAlias": "agency_name",
            "column": "agency_name@checkbook:agency"
        }
    ]
},
"useList":true,
"no_results_content":"No Results Found",
"defaultParameters":{"type_of_year":"B","document_code@checkbook:ref_document_code":"RCT1","status_flag":"A","maximum_contract_amount":"0"},
"defaultParamTypeConfig":{"maximum_contract_amount":"ne"},
"adjustParameters":"
            $adjustedParameters = $parameters;
            if(function_exists('_checkbook_project_applyParameterFilters')){
                  $adjustedParameters = _checkbook_project_applyParameterFilters($node,$parameters);
            }
            return $adjustedParameters;
",
"cleanURLParameters":["year","calyear","agency","yeartype","awdmethod","vendor","status","csize","cindustry"],
"urlParamMap":{"calyear":"fiscal_year_id","year":"fiscal_year_id","agency":"agency_id","yeartype":"type_of_year","awdmethod":"award_method_id","vendor":"vendor_id","status":"status_flag","csize":"award_size_id","cindustry":"industry_type_id"},
"model": {
    "join": {
        "method": "Union"
    },
    "series": [
        {
            "dataset": "checkbook:contracts_coa_aggregates","orderBy":"-maximum_contract_amount",
            "columns": ["vendor_id","legal_name@checkbook:vendor","agency_name@checkbook:agency","agency_id","contract_number","maximum_contract_amount","original_agreement_id","document_code@checkbook:ref_document_code"]
        }
      ]
},
"derivedColumns": {
    "agency_formatted": {
        "type": "expression2",
        "expression": "strtoupper(html_entity_decode($row[\"agency_name@checkbook:agency\"],ENT_QUOTES))"
    },
    "vendor_formatted": {
        "type": "expression2",
        "expression": " strtoupper(html_entity_decode($row[\"legal_name@checkbook:vendor\"],ENT_QUOTES))"
    },
    "column_link":{
        "type":"expression2",
        "expression":" 'contracts_revenue_landing' . _checkbook_project_get_url_param_string('status')  .  _checkbook_project_get_year_url_param_string() . '?expandBottomContURL=/panel_html/contract_transactions/magid/' .  $row['original_agreement_id'] .  '/doctype/' . $row['document_code@checkbook:ref_document_code'] "
    }
},
"limit": "10",
"datasets" : [
    {
        "name": "contracts",
        "type":"string",
        "columns":[{"name":"y","url":"column_link","value":"maximum_contract_amount","agency":"agency_formatted","vendor":"vendor_formatted","contractnum":"contract_number"}],
        "isArray":true,
        "allowNullValues":true
    }
],
"transformationPHP":"
    $node->widgetConfig->chartTitle = _checkbook_project_getChartTitle('contracts','Top Ten Contracts','','contracts');
    return $node->data;
",
"chartConfig" : {
    "chart" : {},
    "colors":["#7DB7E5"],
    "plotOptions":{
        "series": {
            "cursor": "pointer",
            "point": {
                "events": {
                    "function": "clickEvent"
                }
            }
        }
    },
    "xAxis": {
        "title":{"text":""},
        "labels": {"enabled":false}
    },
    "series": [{
        "name": "Contract Amount",
        "type": "column",
        "pointWidth": 30,
        "data": {"ds":"contracts"}
    }],
    "title": {"text": ""},
    "yAxis": {
        "startOnTick":true,
        "title": {"text": ""},
        "labels":{"rotation": 0,"function":"yAxisFormatter"}
    } ,
    "legend": {
        "enabled": false,
        "align": "left",
        "verticalAlign": "bottom",
        "floating": "true",
        "layout": "horizontal"
    },
    "tooltip":{"function":"tooltipformatter"}
}
}


<function>
yAxisFormatter^^'formatter' : function(){return yAxisLabelFormatter(this);}##
tooltipformatter^^'formatter' : function() {return  'Contract ID: ' + this.point.contractnum + '<br/>' + 'Vendor: ' + this.point.vendor  + '<br/>' + 'Contracting Agency: ' + this.point.agency + '<br/>' + 'Amount: ' + abbrNum(this.y, 2, '$') ;}
##clickEvent^^"click": function(){location.href = Drupal.settings.basePath+this.url; }
</function>